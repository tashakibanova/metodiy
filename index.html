<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ú–µ—Ç–æ–¥–∏–π ‚Äî –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      padding: 24px;
    }
    .app {
      width: 100%;
      max-width: 960px;
      background: #020617;
      border-radius: 24px;
      padding: 24px 24px 32px;
      box-shadow: 0 20px 45px rgba(0,0,0,0.6);
      border: 1px solid #1e293b;
    }
    h1 {
      margin: 0 0 8px;
      font-size: 24px;
    }
    .subtitle {
      margin-bottom: 24px;
      color: #9ca3af;
      font-size: 14px;
    }
    label {
      display: block;
      font-size: 14px;
      margin-bottom: 6px;
      color: #d1d5db;
    }
    input[type="text"], select, textarea {
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #374151;
      background: #020617;
      color: #e5e7eb;
      font-size: 14px;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease;
    }
    input[type="text"]:focus,
    select:focus,
    textarea:focus {
      border-color: #38bdf8;
      box-shadow: 0 0 0 1px rgba(56,189,248,0.6);
    }
    textarea {
      min-height: 220px;
      resize: vertical;
      white-space: pre-wrap;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 16px;
      margin-bottom: 16px;
    }
    .field {
      margin-bottom: 16px;
    }
    .btn-row {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-bottom: 16px;
    }
    button {
      border: none;
      border-radius: 999px;
      padding: 10px 20px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      background: linear-gradient(135deg, #22c55e, #14b8a6);
      color: #022c22;
      box-shadow: 0 10px 25px rgba(34,197,94,0.35);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: transform 0.1s ease, box-shadow 0.1s ease, opacity 0.1s ease;
    }
    button:disabled {
      opacity: 0.6;
      cursor: default;
      box-shadow: none;
      transform: none;
    }
    button:not(:disabled):hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(34,197,94,0.45);
    }
    .status {
      font-size: 13px;
      color: #9ca3af;
    }
    .status.error {
      color: #fca5a5;
    }
    .status.success {
      color: #bbf7d0;
    }
    .footer-note {
      margin-top: 12px;
      font-size: 11px;
      color: #6b7280;
    }
    .small {
      font-size: 12px;
      color: #6b7280;
      margin-top: 4px;
    }
    @media (max-width: 640px) {
      .app {
        padding: 16px 16px 24px;
        border-radius: 18px;
      }
    }
  </style>
</head>
<body>
<div class="app">
  <h1>–ú–µ—Ç–æ–¥–∏–π ‚Äî –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</h1>
  <div class="subtitle">
    –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è –Ω–∏–∂–µ –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å¬ª. –ó–∞–ø—Ä–æ—Å —É–π–¥—ë—Ç –≤ n8n-workflow —á–µ—Ä–µ–∑ Webhook, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—è–≤–∏—Ç—Å—è –≤ –ø–æ–ª–µ –æ—Ç–≤–µ—Ç–∞.
  </div>

  <form id="methodic-form">
    <div class="grid">
      <div class="field">
        <label for="topic">–¢–µ–º–∞</label>
        <input id="topic" name="topic" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –†–∞–∑–≤–∏—Ç–∏–µ —Ä–µ—á–∏ –≤ 1 –∫–ª–∞—Å—Å–µ" required />
        <div class="small">–≠—Ç–æ –ø–æ–π–¥—ë—Ç –≤ –ø–æ–ª–µ <code>topic</code> –Ω–∞ –≤—Ö–æ–¥ –Ω–æ–¥—ã <em>Build Payload</em>.</div>
      </div>
      <div class="field">
        <label for="level">–£—Ä–æ–≤–µ–Ω—å / –∫–ª–∞—Å—Å</label>
        <input id="level" name="level" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 1 –∫–ª–∞—Å—Å" required />
        <div class="small">–ü–æ–ª–µ <code>level</code> ‚Äî –∫–∞–∫ –≤ —Ç–≤–æ—ë–º JavaScript: <code>const level = $json.level;</code></div>
      </div>
      <div class="field">
        <label for="type">–í–∏–¥ –º–µ—Ç–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞</label>
        <select id="type" name="type" required>
          <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç‚Ä¶</option>
          <option>–°—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–Ω—è—Ç–∏—è</option>
          <option>–†–∞–±–æ—á–∏–π –ª–∏—Å—Ç</option>
          <option>–ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø–µ–¥–∞–≥–æ–≥–∞</option>
        </select>
        <div class="small">–≠—Ç–æ –ø–æ–ª–µ <code>type</code>, –∫–æ—Ç–æ—Ä–æ–µ —É —Ç–µ–±—è —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ <code>switch (type)</code>.</div>
      </div>
    </div>

    <div class="btn-row">
      <button type="submit" id="submit-btn">
        <span>üöÄ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</span>
      </button>
      <div class="status" id="status-text">–û–∂–∏–¥–∞—é –∑–∞–ø—Ä–æ—Å–∞‚Ä¶</div>
    </div>
  </form>

  <div class="field">
    <label for="result">–†–µ–∑—É–ª—å—Ç–∞—Ç (–æ—Ç–≤–µ—Ç –æ—Ç n8n / LLM)</label>
    <textarea id="result" readonly placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª‚Ä¶"></textarea>
  </div>

  <div class="footer-note">
    –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º: GitHub Pages ‚Üí Webhook (POST) ‚Üí n8n workflow ‚Üí OpenAI ‚Üí Respond to Webhook ‚Üí –æ—Ç–≤–µ—Ç –Ω–∞ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É.
  </div>
</div>

<script>
  // ‚ö†Ô∏è –í–ê–ñ–ù–û: —Å—é–¥–∞ –ø–æ–¥—Å—Ç–∞–≤—å —Å–≤–æ–π URL –≤–µ–±—Ö—É–∫–∞.
  // –î–ª—è —Ç–µ—Å—Ç–æ–≤ ‚Äî Test URL (‚Ä¶/webhook-test/metodiy-kibanova),
  // –¥–ª—è –±–æ–µ–≤–æ–π –≤–µ—Ä—Å–∏–∏ ‚Äî Production URL (‚Ä¶/webhook/metodiy-kibanova).
  const WEBHOOK_URL = "https://edsyteam.app.n8n.cloud/webhook-test/metodiy-kibanova";

  const form = document.getElementById("methodic-form");
  const statusText = document.getElementById("status-text");
  const resultArea = document.getElementById("result");
  const submitBtn = document.getElementById("submit-btn");

  form.addEventListener("submit", async (event) => {
    event.preventDefault();

    const topic = document.getElementById("topic").value.trim();
    const level = document.getElementById("level").value.trim();
    const type = document.getElementById("type").value;

    if (!topic || !level || !type) {
      statusText.textContent = "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π.";
      statusText.className = "status error";
      return;
    }

    const payload = {
      topic,
      level,
      type
      // –∑–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –ø–æ–ª—è, –µ—Å–ª–∏ –æ–Ω–∏ –Ω—É–∂–Ω—ã —Ç–≤–æ–µ–º—É Build Payload
    };

    submitBtn.disabled = true;
    statusText.textContent = "–û—Ç–ø—Ä–∞–≤–ª—è—é –∑–∞–ø—Ä–æ—Å –≤ n8n‚Ä¶";
    statusText.className = "status";

    try {
      const response = await fetch(WEBHOOK_URL, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(payload)
      });

      const contentType = response.headers.get("content-type") || "";
      let data;

      if (contentType.includes("application/json")) {
        data = await response.json();
        resultArea.value = JSON.stringify(data, null, 2);
      } else {
        data = await response.text();
        resultArea.value = data;
      }

      if (!response.ok) {
        statusText.textContent = "–û—à–∏–±–∫–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ n8n (—Å–º. —Ç–µ–∫—Å—Ç –≤—ã—à–µ).";
        statusText.className = "status error";
      } else {
        statusText.textContent = "–ì–æ—Ç–æ–≤–æ! –û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω.";
        statusText.className = "status success";
      }
    } catch (error) {
      console.error(error);
      statusText.textContent = "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å. –ü—Ä–æ–≤–µ—Ä—å URL –≤–µ–±—Ö—É–∫–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å n8n.";
      statusText.className = "status error";
    } finally {
      submitBtn.disabled = false;
    }
  });
</script>
</body>
</html>
